# ABACUS-STRU-Analyser

ğŸ”¬ **é«˜æ•ˆçš„ ABACUS åˆ†å­åŠ¨åŠ›å­¦è½¨è¿¹åˆ†æå·¥å…· v2.0**

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![CI](https://github.com/LoveElysia1314/ABACUS-STRU-Analyser/workflows/CI/badge.svg)](https://github.com/LoveElysia1314/ABACUS-STRU-Analyser/actions)
[![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)

## ğŸš€ v2.0 æ ¸å¿ƒä¼˜åŠ¿

### ğŸ“¦ ç°ä»£åŒ–æ¶æ„
- **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„ `src/` ç›®å½•ç»“æ„ï¼Œä»£ç å¯ç»´æŠ¤æ€§å¤§å¹…æå‡
- **ç±»å‹å®‰å…¨**: å…¨é¢çš„ç±»å‹æ³¨è§£ï¼Œæå‡ä»£ç å¯é æ€§
- **æ ‡å‡†åŒ–é…ç½®**: ä½¿ç”¨ `pyproject.toml` ç°ä»£ Python é¡¹ç›®é…ç½®

### ğŸ”§ å¼€å‘ä½“éªŒ
- **å®Œæ•´æµ‹è¯•**: å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯•ï¼Œç¡®ä¿ä»£ç è´¨é‡
- **è‡ªåŠ¨åŒ–CI/CD**: GitHub Actions è‡ªåŠ¨æµ‹è¯•ã€ä»£ç è´¨é‡æ£€æŸ¥
- **ä»£ç è§„èŒƒ**: Black + Ruff + MyPy ç¡®ä¿ä»£ç é£æ ¼ä¸€è‡´æ€§

### ğŸ›¡ï¸ å¯é æ€§ä¸ç»´æŠ¤æ€§
- **ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ**: é›†ä¸­åŒ–æ—¥å¿—ç®¡ç†ï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§
- **å¼‚å¸¸å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œä¼˜é›…é™çº§
- **å‘åå…¼å®¹**: ä¿æŒ v1.x API å…¼å®¹ï¼Œæ— ç¼å‡çº§

### ğŸ”„ å¯æ‰©å±•æ€§
- **æ’ä»¶åŒ–ç»“æ„**: æ˜“äºæ·»åŠ æ–°çš„åˆ†ææ–¹æ³•å’ŒæŒ‡æ ‡
- **è·¯å¾„ç®¡ç†**: æ™ºèƒ½è·¯å¾„å¤„ç†ï¼Œæ”¯æŒå¢é‡åˆ†æ
- **é…ç½®çµæ´»**: ä¸°å¯Œçš„å‘½ä»¤è¡Œå‚æ•°å’Œé…ç½®é€‰é¡¹

## é¡¹ç›®æ¦‚è¿°

ABACUS-STRU-Analyser æ˜¯ä¸“ä¸º ABACUS åˆ†å­åŠ¨åŠ›å­¦è½¨è¿¹è®¾è®¡çš„é«˜æ•ˆæ‰¹é‡åˆ†æå·¥å…·ã€‚æä¾›ä»è½¨è¿¹å‘ç°ã€è§£æã€æŒ‡æ ‡è®¡ç®—åˆ°æ™ºèƒ½é‡‡æ ·å’Œç»Ÿè®¡åˆ†æçš„å®Œæ•´æµæ°´çº¿ã€‚

### ğŸŒŸ ä¸»è¦ç‰¹æ€§

- **ğŸš€ æ‰¹é‡åˆ†æ**: è‡ªåŠ¨å‘ç°å’Œå¤„ç†å¤šä¸ªåˆ†å­åŠ¨åŠ›å­¦ç³»ç»Ÿ
- **ğŸ¯ æ™ºèƒ½é‡‡æ ·**: æ”¯æŒ Power Meanã€è´ªå©ªæœ€å¤§è·ç¦»ç­‰é‡‡æ ·ç­–ç•¥
- **ğŸ“Š å¤šæ ·æ€§æŒ‡æ ‡**: è®¡ç®— MinDã€ANNDã€MPDã€PCAæ–¹å·®è´¡çŒ®ç‡ ç­‰æ„è±¡å¤šæ ·æ€§æŒ‡æ ‡
- **ğŸ”— ç›¸å…³æ€§åˆ†æ**: æ¸©åº¦å’Œæ„è±¡ç›¸å…³æ€§ç»Ÿè®¡åˆ†æ
- **âš¡ å¹¶è¡Œå¤„ç†**: å¤šè¿›ç¨‹å¹¶è¡Œæå‡åˆ†ææ•ˆç‡
- **ğŸ“ ç»“æœç®¡ç†**: å‚æ•°éš”ç¦»çš„è¾“å‡ºç›®å½•
- **ğŸ”„ å¢é‡è®¡ç®—**: æ™ºèƒ½è·³è¿‡å·²å®Œæˆçš„åˆ†æä»»åŠ¡
- **ğŸ§® PCAé™ç»´**: åŸºäºä¸»æˆåˆ†åˆ†æçš„ç©ºé—´é™ç»´ï¼Œæ‰€æœ‰åˆ†æåœ¨é™ç»´ç©ºé—´è¿›è¡Œ

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.8+
- NumPy, Pandas, SciPy, Scikit-learn

### å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/LoveElysia1314/ABACUS-STRU-Analyser.git
cd ABACUS-STRU-Analyser

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¼€å‘ç¯å¢ƒï¼ˆå¯é€‰ï¼‰
pip install -r requirements-dev.txt
```

### åŸºæœ¬ä½¿ç”¨

```bash
# åˆ†æå½“å‰ç›®å½•
python main_abacus_analyzer.py

# æŒ‡å®šæœç´¢è·¯å¾„å’Œå‚æ•°
python main_abacus_analyzer.py \
    --search_path "/path/to/data" \
    --sample_ratio 0.05 \
    --workers 4

# ç›¸å…³æ€§åˆ†æ
python main_correlation_analyzer.py
```

## é¡¹ç›®ç»“æ„

```
ABACUS-STRU-Analyser/
â”œâ”€â”€ src/                    # æºä»£ç 
â”‚   â”œâ”€â”€ utils/             # å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ data_utils.py  # æ•°æ®éªŒè¯å’Œå¤„ç†
â”‚   â”‚   â””â”€â”€ file_utils.py  # æ–‡ä»¶å’Œç›®å½•æ“ä½œ
â”‚   â”œâ”€â”€ logging/           # æ—¥å¿—ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ manager.py     # é›†ä¸­åŒ–æ—¥å¿—ç®¡ç†
â”‚   â”œâ”€â”€ io/                # è¾“å…¥è¾“å‡º
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ path_manager.py # è·¯å¾„ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ result_saver.py # ç»“æœä¿å­˜
â”‚   â”‚   â””â”€â”€ stru_parser.py  # ç»“æ„æ–‡ä»¶è§£æ
â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒç®—æ³•
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ metrics.py     # ç»Ÿè®¡æŒ‡æ ‡è®¡ç®—
â”‚   â”‚   â”œâ”€â”€ pca_analyzer.py # PCAåˆ†æ
â”‚   â”‚   â”œâ”€â”€ sampler.py     # é‡‡æ ·ç®—æ³•
â”‚   â”‚   â””â”€â”€ system_analyzer.py # ç³»ç»Ÿåˆ†æå™¨
â”‚   â””â”€â”€ analysis/          # åˆ†ææ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ correlation_analyzer.py # ç›¸å…³æ€§åˆ†æ
â”‚       â””â”€â”€ trajectory_analyzer.py # è½¨è¿¹åˆ†æ
â”œâ”€â”€ tests/                 # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ tools/                 # è¿ç§»å·¥å…·
â”œâ”€â”€ .github/               # CI/CDé…ç½®
â”œâ”€â”€ pyproject.toml         # é¡¹ç›®é…ç½®
â”œâ”€â”€ requirements.txt       # è¿è¡Œä¾èµ–
â””â”€â”€ requirements-dev.txt   # å¼€å‘ä¾èµ–
```

## é…ç½®å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `--sample_ratio` | 0.05 | é‡‡æ ·æ¯”ä¾‹ (0.01-1.0) |
| `--power_p` | -0.5 | å¹‚å¹³å‡è·ç¦»çš„på€¼ |
| `--pca_components` | 5 | PCAé™ç»´åçš„ä¸»æˆåˆ†æ•°é‡ |
| `--workers` | auto | å¹¶è¡Œå·¥ä½œè¿›ç¨‹æ•° |
| `--search_path` | å½“å‰ç›®å½• | é€’å½’æœç´¢è·¯å¾„ |
| `--output_dir` | analysis_results | è¾“å‡ºç›®å½• |
| `--force_recompute` | False | å¼ºåˆ¶é‡æ–°è®¡ç®— |

## è¾“å‡ºè¯´æ˜

### ä¸»è¦è¾“å‡ºæ–‡ä»¶

- `system_metrics_summary.csv`: æ‰€æœ‰ç³»ç»Ÿçš„æ±‡æ€»æŒ‡æ ‡
- `pca_components.csv`: æ¯å¸§çš„ä¸»æˆåˆ†åˆ†é‡æ•°æ®
- `analysis_statistics.csv`: åˆ†æç»Ÿè®¡ä¿¡æ¯
- `parameter_analysis_results.csv`: ç›¸å…³æ€§åˆ†æç»“æœ
- `single_analysis_results/`: å•ç³»ç»Ÿè¯¦ç»†ç»“æœ

### æŒ‡æ ‡è¯´æ˜

- **MinD**: æœ€å°é—´è·ï¼ˆMinimum Distanceï¼‰
- **ANND**: å¹³å‡æœ€è¿‘é‚»è·ç¦»ï¼ˆAverage Nearest Neighbor Distanceï¼‰
- **MPD**: å¹³å‡æˆå¯¹è·ç¦»ï¼ˆMean Pairwise Distanceï¼‰
- **PCAæ–¹å·®è´¡çŒ®ç‡**: å„ä¸»æˆåˆ†çš„æ–¹å·®è´¡çŒ®ç‡
- **PCAåˆ†é‡**: æ¯å¸§åœ¨é™ç»´ç©ºé—´ä¸­çš„ä¸»æˆåˆ†åæ ‡

## æ ¸å¿ƒç®—æ³•

### å¤šæ ·æ€§æŒ‡æ ‡è®¡ç®—

#### 1. æœ€å°é—´è· (MinD)
è®¡ç®—æ‰€æœ‰ç‚¹å¯¹ä¹‹é—´çš„æœ€å°æ¬§æ°è·ç¦»ï¼š
```
MinD = min(distance(p_i, p_j) for all i < j)
```

#### 2. å¹³å‡æœ€è¿‘é‚»è·ç¦» (ANND)
è®¡ç®—æ¯ä¸ªç‚¹åˆ°å…¶æœ€è¿‘é‚»ç‚¹çš„å¹³å‡è·ç¦»ï¼š
```
ANND = mean(min(distance(p_i, p_j) for j â‰  i) for all i)
```

#### 3. å¹³å‡æˆå¯¹è·ç¦» (MPD)
è®¡ç®—æ‰€æœ‰ç‚¹å¯¹ä¹‹é—´è·ç¦»çš„å¹³å‡å€¼ï¼š
```
MPD = mean(distance(p_i, p_j) for all i < j)
```

#### 4. PCAé™ç»´åˆ†æ
ä½¿ç”¨ä¸»æˆåˆ†åˆ†æå°†é«˜ç»´æ•°æ®æŠ•å½±åˆ°ä½ç»´ç©ºé—´ï¼š
- ä¿ç•™ä¸»è¦æ–¹å·®æ–¹å‘
- å‡å°‘è®¡ç®—å¤æ‚åº¦
- æä¾›æ•°æ®å¯è§†åŒ–

### æ™ºèƒ½é‡‡æ ·ç­–ç•¥

#### Power Mean é‡‡æ ·
åŸºäºå¹‚å¹³å‡å‡½æ•°çš„é‡‡æ ·ç­–ç•¥ï¼š
```
PowerMean(x, p) = (Î£xáµ¢áµ– / n)^(1/p)
```

#### è´ªå©ªæœ€å¤§è·ç¦»é‡‡æ ·
è¿­ä»£é€‰æ‹©ä¸å·²é€‰ç‚¹é›†è·ç¦»æœ€å¤§çš„ç‚¹ã€‚

## å¼€å‘æŒ‡å—

### è¿è¡Œæµ‹è¯•

```bash
# å•å…ƒæµ‹è¯•
python -m pytest tests/unit/ -v

# çƒŸé›¾æµ‹è¯•
python tests/smoke_test.py

# ä»£ç è´¨é‡æ£€æŸ¥
ruff check src/
black src/ --check
mypy src/
```

### ä» v1.x å‡çº§

v2.0 ä¿æŒå‘åå…¼å®¹ï¼Œç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹ã€‚å¦‚éœ€ä½¿ç”¨æ–°ç‰¹æ€§ï¼š

```python
# v1.x æ–¹å¼ï¼ˆä»ç„¶æ”¯æŒï¼‰
from src.utils import create_logger

# v2.0 æ¨èæ–¹å¼
from src.logging import LoggerManager
logger = LoggerManager.create_logger("my_logger")
```

è¯¦ç»†å‡çº§æŒ‡å—è¯·å‚è€ƒ `UPGRADE_TO_V2.md`ã€‚

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: `git checkout -b feature/new-feature`
3. æäº¤æ›´æ”¹: `git commit -am 'Add new feature'`
4. æ¨é€åˆ†æ”¯: `git push origin feature/new-feature`
5. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## æ›´æ–°æ—¥å¿—

### v2.0.1 (2025-08-28)

#### âœ¨ æ–°ç‰¹æ€§
- **MPDæŒ‡æ ‡**: æ–°å¢å¹³å‡æˆå¯¹è·ç¦»ï¼ˆMean Pairwise Distanceï¼‰æŒ‡æ ‡
- **å¢å¼ºç»Ÿè®¡**: å®Œå–„å¤šæ ·æ€§è¯„ä¼°æŒ‡æ ‡ä½“ç³»

#### ğŸ”§ æ”¹è¿›
- **æŒ‡æ ‡è®¡ç®—**: ä¼˜åŒ–è·ç¦»è®¡ç®—ç®—æ³•
- **ç»“æœè¾“å‡º**: æ‰©å±•CSVè¾“å‡ºå­—æ®µ
- **ä»£ç ç»“æ„**: æ”¹è¿›æ¨¡å—åŒ–è®¾è®¡

### v2.0.0 (2025-08-21)

#### ğŸ‰ é‡å¤§æ”¹è¿›
- **ç°ä»£åŒ–æ¶æ„**: æ¨¡å—åŒ– `src/` ç›®å½•ç»“æ„
- **å¼€å‘å·¥å…·é“¾**: å®Œæ•´çš„æµ‹è¯•ã€CI/CDã€ä»£ç è´¨é‡å·¥å…·
- **ç±»å‹å®‰å…¨**: å…¨é¢ç±»å‹æ³¨è§£æ”¯æŒ
- **é…ç½®æ ‡å‡†åŒ–**: è¿ç§»åˆ° `pyproject.toml`

#### âœ¨ æ–°ç‰¹æ€§
- ç»Ÿä¸€æ—¥å¿—ç®¡ç†ç³»ç»Ÿ
- æ™ºèƒ½è·¯å¾„ç®¡ç†å’Œå¢é‡åˆ†æ
- è‡ªåŠ¨åŒ–è¿ç§»å·¥å…·
- å®Œæ•´çš„æµ‹è¯•è¦†ç›–
- **PCAé™ç»´åˆ†æ**: æ‰€æœ‰åˆ†ææµç¨‹åŸºäºä¸»æˆåˆ†åˆ†æç©ºé—´è¿›è¡Œ

#### ğŸ”§ æ”¹è¿›
- ä¼˜åŒ–å¼‚å¸¸å¤„ç†æœºåˆ¶
- æå‡ä»£ç å¯ç»´æŠ¤æ€§
- å¢å¼ºå‘åå…¼å®¹æ€§
- ç®€åŒ–å¼€å‘æµç¨‹

#### ğŸ“š æ–‡æ¡£
- é‡æ„é¡¹ç›®æ–‡æ¡£
- æ·»åŠ å‡çº§æŒ‡å—
- å®Œå–„APIæ–‡æ¡£

---

**Made with â¤ï¸ for the ABACUS community**
