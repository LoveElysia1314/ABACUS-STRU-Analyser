# ABACUS-STRU-Analyser v2.0 å‡çº§æŒ‡å—

## æ¦‚è¿°

ABACUS-STRU-Analyser v2.0 æ˜¯ä¸€ä¸ªé‡å¤§ç‰ˆæœ¬æ›´æ–°ï¼ŒåŒ…å«äº†æ¶æ„é‡æ„ã€ä»£ç è´¨é‡æ”¹è¿›å’Œæ–°åŠŸèƒ½ã€‚æœ¬æ–‡æ¡£å°†æŒ‡å¯¼æ‚¨ä» v1.x å‡çº§åˆ° v2.0ã€‚

## âš ï¸ é‡è¦æé†’

**è¿™æ˜¯ä¸€ä¸ªç ´åæ€§æ›´æ–°**ã€‚è™½ç„¶æ ¸å¿ƒåˆ†æåŠŸèƒ½ä¿æŒä¸å˜ï¼Œä½†å†…éƒ¨æ¶æ„å’Œä¸€äº› API æ¥å£å‘ç”Ÿäº†å˜åŒ–ã€‚å‡çº§å‰è¯·å¤‡ä»½æ‚¨çš„æ•°æ®å’Œé…ç½®æ–‡ä»¶ã€‚

## ğŸ†• v2.0 æ–°ç‰¹æ€§

### æ¶æ„æ”¹è¿›
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šå°†å¤§å‹ `utils.py` æ‹†åˆ†ä¸ºä¸“é—¨çš„æ¨¡å—
- **ç»Ÿä¸€æ—¥å¿—ç®¡ç†**ï¼šé›†ä¸­çš„æ—¥å¿—é…ç½®å’Œç®¡ç†
- **æ”¹è¿›çš„å¼‚å¸¸å¤„ç†**ï¼šæ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œæ›´å¥½çš„é”™è¯¯æ¢å¤
- **ç±»å‹æ³¨è§£**ï¼šæ·»åŠ äº†ç±»å‹æç¤ºä»¥æé«˜ä»£ç è´¨é‡

### å¼€å‘å·¥å…·
- **é™æ€åˆ†æå·¥å…·**ï¼šé›†æˆäº† ruffã€blackã€mypy
- **æµ‹è¯•æ¡†æ¶**ï¼šå®Œæ•´çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **CI/CD æµç¨‹**ï¼šè‡ªåŠ¨åŒ–çš„ä»£ç è´¨é‡æ£€æŸ¥

### åŠŸèƒ½å¢å¼º
- **å¢å¼ºçš„è·¯å¾„ç®¡ç†**ï¼šæ›´å¥½çš„æ–‡ä»¶ç»„ç»‡å’Œè·¯å¾„å¤„ç†
- **æ”¹è¿›çš„ç»“æœä¿å­˜**ï¼šæ›´çµæ´»çš„ç»“æœä¿å­˜é€‰é¡¹
- **æ›´å¥½çš„é”™è¯¯å¤„ç†**ï¼šè¯¦ç»†çš„é”™è¯¯æ—¥å¿—å’Œå †æ ˆè·Ÿè¸ª

## ğŸ“‹ å‡çº§å‰å‡†å¤‡

### 1. å¤‡ä»½ç°æœ‰æ•°æ®
```bash
# å¤‡ä»½æ•´ä¸ªé¡¹ç›®ç›®å½•
cp -r /path/to/old/project /path/to/backup/project_v1_backup

# æˆ–è€…åªå¤‡ä»½é‡è¦çš„ç»“æœæ–‡ä»¶
cp -r analysis_results analysis_results_backup
```

### 2. æ£€æŸ¥ Python ç‰ˆæœ¬
v2.0 è¦æ±‚ Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼š
```bash
python --version  # åº”è¯¥æ˜¾ç¤º 3.8+ 
```

### 3. è®°å½•å½“å‰é…ç½®
è®°å½•æ‚¨å½“å‰ä½¿ç”¨çš„å‘½ä»¤è¡Œå‚æ•°å’Œé…ç½®æ–‡ä»¶ï¼Œä»¥ä¾¿åœ¨å‡çº§åé‡æ–°é…ç½®ã€‚

## ğŸ”„ å‡çº§æ­¥éª¤

### æ–¹æ³•ä¸€ï¼šè‡ªåŠ¨è¿ç§»ï¼ˆæ¨èï¼‰

1. **è·å– v2.0 ä»£ç **
```bash
git checkout refactor/v2
# æˆ–ä¸‹è½½ v2.0 release
```

2. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
pip install -r requirements-dev.txt  # å¯é€‰ï¼Œç”¨äºå¼€å‘
```

3. **è¿è¡Œè¿ç§»è„šæœ¬**
```bash
python tools/migration/migrate_v1_to_v2.py /path/to/old/data /path/to/new/data

# å…ˆè¿›è¡Œå¹²è¿è¡Œæµ‹è¯•
python tools/migration/migrate_v1_to_v2.py /path/to/old/data /path/to/new/data --dry-run
```

4. **éªŒè¯è¿ç§»ç»“æœ**
```bash
# è¿è¡ŒçƒŸé›¾æµ‹è¯•
python tests/smoke_test.py

# æ£€æŸ¥è¿ç§»æŠ¥å‘Š
cat /path/to/new/data/migration_report.json
```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å‡çº§

å¦‚æœè‡ªåŠ¨è¿ç§»ä¸é€‚ç”¨ï¼Œå¯ä»¥æ‰‹åŠ¨å‡çº§ï¼š

1. **é‡æ–°ç»„ç»‡æ–‡ä»¶ç»“æ„**
```
æ–°çš„ v2.0 ç»“æ„ï¼š
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ utils/           # æ‹†åˆ†åçš„å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ logging/         # ä¸“é—¨çš„æ—¥å¿—ç®¡ç†
â”‚   â”œâ”€â”€ core/           # æ ¸å¿ƒåˆ†æåŠŸèƒ½
â”‚   â”œâ”€â”€ io/             # è¾“å…¥è¾“å‡ºå¤„ç†
â”‚   â””â”€â”€ analysis/       # åˆ†æç®—æ³•
â”œâ”€â”€ tests/              # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ tools/              # å·¥å…·è„šæœ¬
â””â”€â”€ analysis_results/   # åˆ†æç»“æœ
```

2. **æ›´æ–°å¯¼å…¥è¯­å¥**
```python
# v1.x
from src.utils import create_standard_logger, ValidationUtils

# v2.0
from src.logging import create_standard_logger
from src.utils import ValidationUtils
```

3. **æ›´æ–°é…ç½®æ–‡ä»¶**
æ£€æŸ¥å¹¶æ›´æ–°é…ç½®æ–‡ä»¶ä»¥ä½¿ç”¨æ–°çš„æ ¼å¼ã€‚

## ğŸ”§ API å˜æ›´

### æ—¥å¿—ç®¡ç†
```python
# v1.x
from src.utils import create_standard_logger

# v2.0
from src.logging import create_standard_logger, LoggerManager

# æ–°çš„é«˜çº§ç”¨æ³•
logger = LoggerManager.create_analysis_logger("analysis", output_dir)
```

### æ–‡ä»¶æ“ä½œ
```python
# v1.x
from src.utils import FileUtils

# v2.0 - åŸºæœ¬ç”¨æ³•ä¸å˜ï¼Œä½†æœ‰æ–°åŠŸèƒ½
from src.utils import FileUtils

# æ–°å¢åŠŸèƒ½
FileUtils.safe_read_csv(filepath)
FileUtils.safe_remove(filepath)
```

### æ•°æ®éªŒè¯
```python
# v1.x
from src.utils import ValidationUtils

# v2.0 - åŸºæœ¬ç”¨æ³•ä¸å˜
from src.utils import ValidationUtils

# ç°åœ¨æœ‰æ›´å¤šéªŒè¯æ–¹æ³•
ValidationUtils.is_empty(data)  # æ”¹è¿›çš„ç©ºæ£€æŸ¥
```

## ğŸš¨ å·²çŸ¥çš„ç ´åæ€§å˜æ›´

### 1. æ¨¡å—é‡ç»„
- `src.utils` ä¸­çš„ä¸€äº›ç±»ç§»åŠ¨åˆ°äº†ä¸“é—¨çš„å­æ¨¡å—
- æ—¥å¿—ç›¸å…³åŠŸèƒ½ç§»åŠ¨åˆ° `src.logging`

### 2. å¼‚å¸¸å¤„ç†
- ä¸å†é™é»˜å¿½ç•¥å¼‚å¸¸ï¼Œä¼šæä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
- æŸäº›é”™è¯¯ç°åœ¨ä¼šè®°å½•åˆ°æ—¥å¿—æ–‡ä»¶

### 3. æ–‡ä»¶è·¯å¾„
- æ—¥å¿—æ–‡ä»¶ä½ç½®å¯èƒ½å‘ç”Ÿå˜åŒ–
- æŸäº›ä¸´æ—¶æ–‡ä»¶çš„å‘½åçº¦å®šå¯èƒ½ä¸åŒ

## ğŸ§ª éªŒè¯å‡çº§

### 1. è¿è¡Œæµ‹è¯•å¥—ä»¶
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest tests/

# è¿è¡Œç‰¹å®šæµ‹è¯•
pytest tests/unit/
pytest tests/integration/
```

### 2. çƒŸé›¾æµ‹è¯•
```bash
python tests/smoke_test.py
```

### 3. åŠŸèƒ½éªŒè¯
ä½¿ç”¨ä¸€ä¸ªå°çš„æµ‹è¯•æ•°æ®é›†è¿è¡Œå®Œæ•´çš„åˆ†ææµç¨‹ï¼š
```bash
python main_abacus_analyzer.py --sample-ratio 0.1 --power-p -0.5 test_data/
```

## ğŸ› å¸¸è§é—®é¢˜

### Q: å‡çº§åæ— æ³•æ‰¾åˆ°æŸäº›æ¨¡å—
A: æ£€æŸ¥å¯¼å…¥è¯­å¥æ˜¯å¦éœ€è¦æ›´æ–°ã€‚å‚è€ƒä¸Šé¢çš„ API å˜æ›´éƒ¨åˆ†ã€‚

### Q: æ—¥å¿—æ ¼å¼å‘ç”Ÿå˜åŒ–
A: v2.0 ä½¿ç”¨äº†ç»Ÿä¸€çš„æ—¥å¿—æ ¼å¼ã€‚å¦‚æœéœ€è¦è‡ªå®šä¹‰ï¼Œä½¿ç”¨ `LoggerManager` çš„å‚æ•°ã€‚

### Q: æ€§èƒ½æ˜¯å¦å—åˆ°å½±å“ï¼Ÿ
A: v2.0 çš„æ ¸å¿ƒç®—æ³•æ²¡æœ‰å˜åŒ–ï¼Œæ€§èƒ½åº”è¯¥ä¿æŒç›¸åŒæˆ–ç•¥æœ‰æ”¹å–„ã€‚

### Q: å¯ä»¥åŒæ—¶ä¿ç•™ v1.x å’Œ v2.0 å—ï¼Ÿ
A: å¯ä»¥ï¼Œå»ºè®®å°†å®ƒä»¬å®‰è£…åœ¨ä¸åŒçš„ç›®å½•æˆ–è™šæ‹Ÿç¯å¢ƒä¸­ã€‚

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœåœ¨å‡çº§è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æ£€æŸ¥è¿ç§»æ—¥å¿—**ï¼š`migration.log` å’Œ `migration_report.json`
2. **è¿è¡Œè¯Šæ–­**ï¼š`python tests/smoke_test.py --verbose`
3. **æŸ¥çœ‹æ–‡æ¡£**ï¼šREADME.md å’Œä»£ç æ³¨é‡Š
4. **æäº¤ Issue**ï¼šåœ¨é¡¹ç›®ä»“åº“ä¸­æŠ¥å‘Šé—®é¢˜

## ğŸ”„ å›æ»šè®¡åˆ’

å¦‚æœå‡çº§åé‡åˆ°ä¸¥é‡é—®é¢˜ï¼Œå¯ä»¥å›æ»šåˆ° v1.xï¼š

1. **æ¢å¤å¤‡ä»½**
```bash
rm -rf /path/to/project
cp -r /path/to/backup/project_v1_backup /path/to/project
```

2. **åˆ‡æ¢åˆ° v1.x åˆ†æ”¯**
```bash
git checkout main  # æˆ–ä¹‹å‰çš„ç¨³å®šåˆ†æ”¯
```

3. **æ¢å¤ä¾èµ–**
```bash
pip install -r requirements.txt
```

## âœ… å‡çº§æ£€æŸ¥æ¸…å•

- [ ] å¤‡ä»½ç°æœ‰æ•°æ®å’Œé…ç½®
- [ ] æ£€æŸ¥ Python ç‰ˆæœ¬ (â‰¥3.8)
- [ ] è·å– v2.0 ä»£ç 
- [ ] å®‰è£…æ–°ä¾èµ–
- [ ] è¿è¡Œè¿ç§»è„šæœ¬
- [ ] éªŒè¯è¿ç§»ç»“æœ
- [ ] è¿è¡Œæµ‹è¯•å¥—ä»¶
- [ ] æ‰§è¡ŒåŠŸèƒ½éªŒè¯
- [ ] æ›´æ–°ä½¿ç”¨æ–‡æ¡£
- [ ] åŸ¹è®­å›¢é˜Ÿæˆå‘˜ï¼ˆå¦‚é€‚ç”¨ï¼‰

---

**å‡çº§æ„‰å¿«ï¼å¦‚æœ‰ç–‘é—®ï¼Œè¯·æŸ¥é˜…æ–‡æ¡£æˆ–è”ç³»ç»´æŠ¤å›¢é˜Ÿã€‚**
